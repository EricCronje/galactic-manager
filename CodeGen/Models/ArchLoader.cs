// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:15 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:14 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:14 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:13 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:13 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:13 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:12 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:12 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:12 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:11 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:11 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:10 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:10 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:10 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:09 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:09 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:09 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:09 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:08 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:08 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:07 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:07 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:07 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:22:06 - {c1d05dfd-4286-4a76-b6a6-7374f9cebc98}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:17:26 - {bc074cbe-aae5-4d1e-aa83-fa69cd2e48f4}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:17:26 - {bc074cbe-aae5-4d1e-aa83-fa69cd2e48f4}
// Generated Code - Version: 23.11.25 - 2024/11/20 17:17:26 - {bc074cbe-aae5-4d1e-aa83-fa69cd2e48f4}
// Generated Code - Version: 23.11.25 - 2024/11/18 21:08:58 - {3a6d9981-e6ad-4c67-848b-61b518dfa8f8}

using ArchCorpUtilities.Utilities;
using MH = ArchCorpUtilities.Models.Menus.MenuHelper;
using CH = ArchCorpUtilities.Utilities.ConsoleHelper;
using L = Logger.Logger;
using MMH = ArchCorpUtilities.Models.Menus.MenuMaintenanceHelper;
using U = ArchCorpUtilities.Utilities.UniversalUtilities;
using TTH = ArchCorpUtilities.Models.TargetTaskHelper;
using CodeGen = ArchCorpUtilities.Utilities.CodeGenHelper;

//{0ACDC688-3120-452F-94AE-2DD1771A9991}
using BuildingsHelper = ArchCorpUtilities.GeneratedModels.BuildingsModel.BuildingsHelper;
using SitesHelper = ArchCorpUtilities.GeneratedModels.SitesModel.SitesHelper;
using BuildingSiteHelper = ArchCorpUtilities.GeneratedModels.BuildingSiteModel.BuildingSiteHelper;
using BuildingTypeHelper = ArchCorpUtilities.GeneratedModels.BuildingTypeModel.BuildingTypeHelper;
using PlanetsHelper = ArchCorpUtilities.GeneratedModels.PlanetsModel.PlanetsHelper;
using PlanetTypeHelper = ArchCorpUtilities.GeneratedModels.PlanetTypeModel.PlanetTypeHelper;
using PersonnelHelper = ArchCorpUtilities.GeneratedModels.PersonnelModel.PersonnelHelper;
using PersonnelTypeHelper = ArchCorpUtilities.GeneratedModels.PersonnelTypeModel.PersonnelTypeHelper;
using ShipsHelper = ArchCorpUtilities.GeneratedModels.ShipsModel.ShipsHelper;
using ShipTypeHelper = ArchCorpUtilities.GeneratedModels.ShipTypeModel.ShipTypeHelper;
using FleetsHelper = ArchCorpUtilities.GeneratedModels.FleetsModel.FleetsHelper;
using UsersHelper = ArchCorpUtilities.GeneratedModels.UsersModel.UsersHelper;
using RolesHelper = ArchCorpUtilities.GeneratedModels.RolesModel.RolesHelper;
using RoleGroupsHelper = ArchCorpUtilities.GeneratedModels.RoleGroupsModel.RoleGroupsHelper;
using BeaconsHelper = ArchCorpUtilities.GeneratedModels.BeaconsModel.BeaconsHelper;
using RoutesHelper = ArchCorpUtilities.GeneratedModels.RoutesModel.RoutesHelper;
using LinkBuildingsTypesBuildingsHelper = ArchCorpUtilities.GeneratedModels.LinkBuildingsTypesBuildingsModel.LinkBuildingsTypesBuildingsHelper;
using LinkBuildingsSitesHelper = ArchCorpUtilities.GeneratedModels.LinkBuildingsSitesModel.LinkBuildingsSitesHelper;
using LinkSitePlanetHelper = ArchCorpUtilities.GeneratedModels.LinkSitePlanetModel.LinkSitePlanetHelper;
using LinkPlanetTypesPlanetHelper = ArchCorpUtilities.GeneratedModels.LinkPlanetTypesPlanetModel.LinkPlanetTypesPlanetHelper;
using LinkPersonnelShipHelper = ArchCorpUtilities.GeneratedModels.LinkPersonnelShipModel.LinkPersonnelShipHelper;
using LinkPersonnelPersonnelTypeHelper = ArchCorpUtilities.GeneratedModels.LinkPersonnelPersonnelTypeModel.LinkPersonnelPersonnelTypeHelper;
using LinkShipFleetHelper = ArchCorpUtilities.GeneratedModels.LinkShipFleetModel.LinkShipFleetHelper;
using LinkShipTypeShipHelper = ArchCorpUtilities.GeneratedModels.LinkShipTypeShipModel.LinkShipTypeShipHelper;
using LinkUserRoleHelper = ArchCorpUtilities.GeneratedModels.LinkUserRoleModel.LinkUserRoleHelper;
using LinkRoleRoleGroupHelper = ArchCorpUtilities.GeneratedModels.LinkRoleRoleGroupModel.LinkRoleRoleGroupHelper;
using LinkBeaconRouteHelper = ArchCorpUtilities.GeneratedModels.LinkBeaconRouteModel.LinkBeaconRouteHelper;
//{0ACDC688-3120-452F-94AE-2DD1771A9991}

using ArchCorpUtilities.Models.Menus;

namespace ArchCorpUtilities.Models
{
    public static class ArchLoader
    {
        
        public static string SessionID { get; }

        //{048A4DD6-2F1B-4178-A732-E3B50D3F0791}
		internal static BuildingsHelper? BuildingsHelper = null;
		internal static SitesHelper? SitesHelper = null;
		internal static BuildingSiteHelper? BuildingSiteHelper = null;
		internal static BuildingTypeHelper? BuildingTypeHelper = null;
		internal static PlanetsHelper? PlanetsHelper = null;
		internal static PlanetTypeHelper? PlanetTypeHelper = null;
		internal static PersonnelHelper? PersonnelHelper = null;
		internal static PersonnelTypeHelper? PersonnelTypeHelper = null;
		internal static ShipsHelper? ShipsHelper = null;
		internal static ShipTypeHelper? ShipTypeHelper = null;
		internal static FleetsHelper? FleetsHelper = null;
		internal static UsersHelper? UsersHelper = null;
		internal static RolesHelper? RolesHelper = null;
		internal static RoleGroupsHelper? RoleGroupsHelper = null;
		internal static BeaconsHelper? BeaconsHelper = null;
		internal static RoutesHelper? RoutesHelper = null;
		internal static LinkBuildingsTypesBuildingsHelper? LinkBuildingsTypesBuildingsHelper = null;
		internal static LinkBuildingsSitesHelper? LinkBuildingsSitesHelper = null;
		internal static LinkSitePlanetHelper? LinkSitePlanetHelper = null;
		internal static LinkPlanetTypesPlanetHelper? LinkPlanetTypesPlanetHelper = null;
		internal static LinkPersonnelShipHelper? LinkPersonnelShipHelper = null;
		internal static LinkPersonnelPersonnelTypeHelper? LinkPersonnelPersonnelTypeHelper = null;
		internal static LinkShipFleetHelper? LinkShipFleetHelper = null;
		internal static LinkShipTypeShipHelper? LinkShipTypeShipHelper = null;
		internal static LinkUserRoleHelper? LinkUserRoleHelper = null;
		internal static LinkRoleRoleGroupHelper? LinkRoleRoleGroupHelper = null;
		internal static LinkBeaconRouteHelper? LinkBeaconRouteHelper = null;
		//{048A4DD6-2F1B-4178-A732-E3B50D3F0791}

        static ArchLoader()
        {
            SessionID = Guid.NewGuid().ToString();
            MH.SessionID = SessionID;
            MMH.SessionID = SessionID;
            U.SessionID = SessionID;
            TTH.SessionID = SessionID;
            CodeGen.SessionID = SessionID;

            //{9ED7AF33-DE0E-45C3-821F-4669558AD744}
			BuildingsHelper = new(SessionID);
			SitesHelper = new(SessionID);
			BuildingSiteHelper = new(SessionID);
			BuildingTypeHelper = new(SessionID);
			PlanetsHelper = new(SessionID);
			PlanetTypeHelper = new(SessionID);
			PersonnelHelper = new(SessionID);
			PersonnelTypeHelper = new(SessionID);
			ShipsHelper = new(SessionID);
			ShipTypeHelper = new(SessionID);
			FleetsHelper = new(SessionID);
			UsersHelper = new(SessionID);
			RolesHelper = new(SessionID);
			RoleGroupsHelper = new(SessionID);
			BeaconsHelper = new(SessionID);
			RoutesHelper = new(SessionID);
			LinkBuildingsTypesBuildingsHelper = new(SessionID);
			LinkBuildingsSitesHelper = new(SessionID);
			LinkSitePlanetHelper = new(SessionID);
			LinkPlanetTypesPlanetHelper = new(SessionID);
			LinkPersonnelShipHelper = new(SessionID);
			LinkPersonnelPersonnelTypeHelper = new(SessionID);
			LinkShipFleetHelper = new(SessionID);
			LinkShipTypeShipHelper = new(SessionID);
			LinkUserRoleHelper = new(SessionID);
			LinkRoleRoleGroupHelper = new(SessionID);
			LinkBeaconRouteHelper = new(SessionID);
			//{9ED7AF33-DE0E-45C3-821F-4669558AD744}

        }

        public static void RunArch(List<Command>? commands = null, int logLevel = 1)
        {
            if (commands != null || commands?.Count > 0)
            {
                CH.IsSimulate = true;
            }

            //{E4C217C0-AC0D-4571-95E4-16CE056F35A5}
			BuildingsHelper?.LoadDefaults();
			SitesHelper?.LoadDefaults();
			BuildingSiteHelper?.LoadDefaults();
			BuildingTypeHelper?.LoadDefaults();
			PlanetsHelper?.LoadDefaults();
			PlanetTypeHelper?.LoadDefaults();
			PersonnelHelper?.LoadDefaults();
			PersonnelTypeHelper?.LoadDefaults();
			ShipsHelper?.LoadDefaults();
			ShipTypeHelper?.LoadDefaults();
			FleetsHelper?.LoadDefaults();
			UsersHelper?.LoadDefaults();
			RolesHelper?.LoadDefaults();
			RoleGroupsHelper?.LoadDefaults();
			BeaconsHelper?.LoadDefaults();
			RoutesHelper?.LoadDefaults();
			LinkBuildingsTypesBuildingsHelper?.LoadDefaults();
			LinkBuildingsSitesHelper?.LoadDefaults();
			LinkSitePlanetHelper?.LoadDefaults();
			LinkPlanetTypesPlanetHelper?.LoadDefaults();
			LinkPersonnelShipHelper?.LoadDefaults();
			LinkPersonnelPersonnelTypeHelper?.LoadDefaults();
			LinkShipFleetHelper?.LoadDefaults();
			LinkShipTypeShipHelper?.LoadDefaults();
			LinkUserRoleHelper?.LoadDefaults();
			LinkRoleRoleGroupHelper?.LoadDefaults();
			LinkBeaconRouteHelper?.LoadDefaults();
			//{E4C217C0-AC0D-4571-95E4-16CE056F35A5}

            if (File.Exists(CodeGenHelper.CurrentGuid))
                MMH.Load(CodeGenHelper.CurrentGuid);
			
            L.CurrentLevel = logLevel;
            L.Log(System.Reflection.MethodBase.GetCurrentMethod()?.Name, SessionID);
            int? SimChoice = null;
            string? SimInput = null;
            string[]? SimInputValues = null;

            if (commands == null || commands.Count == 0)
            {
                CH.IsSimulate = false;
            }
            if (commands != null)
            {
                CH.IsSimulate = true;
                //Simulate
                SimChoice = 1; // just to get in the loop
                SimInput = "";
                SimInputValues = null;
            }
            //Retrieve starting page
            int? TargetPage = MH.Menu?.FirstOrDefault(c => c.IsStartPage == true)?.Page;
            
            if (TargetPage != null)
            {
                var PrevPagenumber = TargetPage;
                var PageHeading = MH.Menu?.FirstOrDefault(c => c.Page == TargetPage)?.PageHeading;


                int Choice = ShowMenu(TargetPage, PageHeading, SimChoice);


                var ExitOption = MH.Menu?.FirstOrDefault(c => c.IsExitOption && c.Page == TargetPage)?.DisplayNumber;

                L.Log($"Before loop - Choice: {Choice} TargetPage: {TargetPage.Value}", SessionID, 0);

                int Counter = 0;
                while (Choice != ExitOption)
                {

                    if (CH.IsSimulate && commands != null && Counter < commands?.Count)
                    {
                        SimInput = commands[Counter].Value;
                        SimChoice = commands[Counter].Choice;
                        SimInputValues = commands[Counter].Values;
                        if (SimChoice != null)
                            Choice = SimChoice.Value;
                        CH.Feedback($"Simulate: {SimInput} -- {SimChoice} --- {SimInputValues?.ToString()}");
                        Counter++;
                        L.Log($"Inside loop - Simulation - Choice: {Choice} TargetPage: {TargetPage.Value}", SessionID, 2);
                    }



                    if (!CH.IsSimulate) { Console.Clear(); }
                    if (CH.IsSimulate) { CH.Feedback(Resource.ClearConsoleMessage); }

                    var menuItem = MH.Menu?.FirstOrDefault(c => c.DisplayNumber == Choice && c.Page == TargetPage && c.IsHidden == false);

                    if (menuItem != null && menuItem.TargetPage != 0) { TargetPage = menuItem.TargetPage; }

                    PageHeading = MH.Menu?.FirstOrDefault(c => c.Page == TargetPage.Value)?.PageHeading;

                    ExitOption = MH.Menu?.FirstOrDefault(c => c.IsExitOption && c.Page == TargetPage.Value)?.DisplayNumber;

                    L.Log($"Inside loop - Before PerformDefaultTasks - Choice: {Choice} TargetPage: {TargetPage.Value}", SessionID, 2);


                    TTH.PerformDefaultTasks(TargetPage.Value, PrevPagenumber.Value, Choice, SimChoice, SimInput, SimInputValues);
                                      
                    Choice = ShowMenu(TargetPage.Value, PageHeading, SimChoice);

                    PrevPagenumber = TargetPage.Value;

                    if (Counter == commands?.Count)
                        ExitOption = Choice;
                    else
                        ExitOption = MH.Menu?.FirstOrDefault(c => c.IsExitOption && c.Page == TargetPage)?.DisplayNumber;
                }
                if (CH.IsSimulate) { CH.Feedback(Resource.ExitIndicator); }
                L.Log($"After loop - Choice: {Choice} TargetPage: {TargetPage.Value}", SessionID, 2);
            }
            else
            {
                CH.Feedback(Resource.TargetPageNotSet);
                L.Log($"TargetPage is not marked - fix the menu structure", SessionID, 9);
            }
        }

        static int ShowMenu(int? page, string? menuHeading, int? simChoice = null)
        {
            CH.Feedback(MH.ShowMenu(menuHeading, page));

            if (simChoice == null)
            {
                _ = int.TryParse(CH.GetInput(), out int Choice);
                simChoice = Choice;
            }

            return simChoice.Value;
        }

    }
}
